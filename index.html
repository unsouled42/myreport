<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fidelity TAS 5.0 ‚Äì QA Report</title>

  <!-- Docsify Theme -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify/lib/themes/vue.css" />

  <style>
    body { font-family: "Segoe UI", Roboto, sans-serif; padding-top: 70px; margin: 0; }
    img { cursor: zoom-in; border-radius: 4px; margin: 8px 0 16px; box-shadow: 0 2px 12px rgba(0,0,0,.15); max-width: 100%; }
    figure { margin: 1.5em 0; text-align: center; }
    figcaption { margin-top: .5em; font-size: 14px; color: #555; font-style: italic; }

    /* Fixed Navigation Bar */
    nav { position: fixed; top: 0; left: 0; width: 100%; background: #fff; border-bottom: 1px solid #e0e0e0; z-index: 1000; box-shadow: 0 1px 6px rgba(0,0,0,.05); }
    .nav-container { margin-left: 300px; max-width: 960px; padding: 10px 20px; display: flex; justify-content: center; gap: 16px; align-items: center; }
    .nav-container a { font-size: 14px; text-decoration: none; padding: 6px 14px; border-radius: 6px; font-weight: 500; color: #333; transition: background .2s, color .2s; white-space: nowrap; }
    .nav-container a:hover { background: #f0f0f0; }
    .nav-tab-active { background: #e8f5e9 !important; font-weight: 600; color: #2e7d32 !important; }

    @media (max-width: 768px) {
      .nav-container { margin-left: 0; padding: 10px 12px; flex-wrap: wrap; justify-content: center; gap: 10px; }
      body { padding-top: 110px; }
    }
  </style>
</head>
<body>
  <div id="app">Loading report...</div>

  <!-- Fixed Navigation Bar -->
  <nav>
    <div class="nav-container">
      <a id="nav-overview" href="#/">üè† Overview</a>
      <a id="nav-dev" href="#/dev/">üß™ DEV</a>
      <a id="nav-uat" href="#/uat/">üöÄ UAT</a>
      <a id="nav-prod" href="#/prod/">‚úÖ PROD</a>
      <a id="nav-api" href="#/api/">üîå API Tests</a>
    </div>
  </nav>

  <!-- Docsify config BEFORE scripts -->
  <script>
    window.$docsify = {
      name: 'Fidelity TAS 5.0 ‚Äì QA & Performance Testing',
      repo: '',
      homepage: 'README.md',
      loadSidebar: true,
      loadNavbar: false,
      subMaxLevel: 2,
      themeColor: '#42b983',
      search: 'auto',

      alias: {
        '/dev/': '/dev/report.md',
        '/uat/': '/uat/report.md',
        '/prod/': '/prod/report.md',
        '/uat/perf_testing.md': '/uat/perf_testing.md',
        '/api/': '/api_testing.md',
        /* Fix 404s when routing into subpaths */
        '/.*/_sidebar.md': '/_sidebar.md',
        '/.*/_navbar.md': '/_navbar.md'
      },

      updated: {
        text: 'Last updated:',
        format: '{YYYY}-{MM}-{DD} {HH}:{mm}',
        type: 'datetime'
      },

      /* Mermaid options */
      mermaidConfig: { startOnLoad: true, theme: 'default' },

      /* Custom plugins */
      plugins: [
        function (hook, vm) {
          // Re-apply zoom + nav highlighting after each route
          hook.doneEach(function () {
            if (window.mediumZoomInstance) window.mediumZoomInstance.detach();
            window.mediumZoomInstance = mediumZoom('img:not(a img)', {
              margin: 24, background: 'rgba(0,0,0,0.85)', scrollOffset: 0, transitionDuration: 150
            });

            const routes = ['/', '/dev/', '/uat/', '/prod/', '/api/'];
            routes.forEach(r => {
              const id = 'nav-' + (r === '/' ? 'overview' : r.replaceAll('/', ''));
              const link = document.getElementById(id);
              if (link) link.classList.toggle('nav-tab-active', vm.route.path.startsWith(r));
            });
          });

          // üîß Manual Mermaid renderer: convert fenced blocks to <div class="mermaid"> and init
          hook.doneEach(function () {
            try {
              var blocks = document.querySelectorAll('pre[data-lang="mermaid"]');
              blocks.forEach(function (pre) {
                // Skip if already converted
                if (pre.dataset.mermaidProcessed === 'true') return;
                var code = pre.querySelector('code');
                var graph = code ? code.textContent : pre.textContent;
                var container = document.createElement('div');
                container.className = 'mermaid';
                container.textContent = graph;
                pre.parentNode.replaceChild(container, pre);
                container.dataset.mermaidProcessed = 'true';
              });

              if (window.mermaid) {
                // (Re)initialize on each page
                window.mermaid.initialize(vm.config.mermaidConfig || { startOnLoad: true });
                window.mermaid.init(undefined, document.querySelectorAll('.mermaid'));
              }
            } catch (e) {
              console.error('Mermaid render error:', e);
            }
          });
        }
      ]
    };
  </script>

  <!-- JS Libraries (AFTER config) -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify-updated/src/docsify-updated.min.js"></script>

  <!-- Mermaid core ONLY (no external docsify-mermaid plugin needed) -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
